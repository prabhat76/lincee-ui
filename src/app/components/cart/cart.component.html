<div class="cart-container">
  <div class="cart-header">
    <h1>Shopping Cart</h1>
    <p *ngIf="cartCount() > 0">{{ cartCount() }} {{ cartCount() === 1 ? 'item' : 'items' }} in your cart</p>
    <p *ngIf="cartCount() === 0">Your cart is empty</p>
  </div>

  <div class="cart-empty" *ngIf="cartItems().length === 0">
    <mat-icon>shopping_cart</mat-icon>
    <h2>Your cart is empty</h2>
    <p>Looks like you haven't added anything to your cart yet.</p>
    <button mat-raised-button color="primary" (click)="continueShopping()">
      <mat-icon>store</mat-icon>
      START SHOPPING
    </button>
  </div>

  <div class="cart-content" *ngIf="cartItems().length > 0">
    <div class="cart-items">
      <mat-card class="cart-item" *ngFor="let item of cartItems()">
        <div class="item-image">
          <img [src]="getImageUrl(item.product)" [alt]="item.product.name" 
               onerror="this.src='assets/placeholder.png'" />
        </div>
        
        <div class="item-details">
          <h3>{{ item.product.name }}</h3>
          <p class="item-category">{{ item.product.category }}</p>
          <p class="item-size" *ngIf="item.size">Size: {{ item.size }}</p>
          <p class="item-price">${{ item.product.price }}</p>
          
          <div class="stock-warning" *ngIf="item.product.stockQuantity <= 5">
            <mat-icon>warning</mat-icon>
            Only {{ item.product.stockQuantity }} left in stock
          </div>
        </div>

        <div class="item-quantity">
          <label>Quantity</label>
          <div class="quantity-controls">
            <button mat-icon-button (click)="decrementQuantity(item)">
              <mat-icon>remove</mat-icon>
            </button>
            <span class="quantity-display">{{ item.quantity }}</span>
            <button mat-icon-button (click)="incrementQuantity(item)"
                    [disabled]="item.quantity >= item.product.stockQuantity">
              <mat-icon>add</mat-icon>
            </button>
          </div>
        </div>

        <div class="item-subtotal">
          <label>Subtotal</label>
          <p class="subtotal-amount">${{ getItemSubtotal(item) }}</p>
        </div>

        <button mat-icon-button class="remove-btn" (click)="removeItem(item.product.id, item.size)">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card>
    </div>

    <div class="cart-summary">
      <mat-card class="summary-card">
        <h2>Order Summary</h2>
        
        <div class="summary-row">
          <span>Subtotal</span>
          <span>${{ cartTotal() }}</span>
        </div>
        
        <div class="summary-row">
          <span>Shipping</span>
          <span class="free-shipping">FREE</span>
        </div>
        
        <mat-divider></mat-divider>
        
        <div class="summary-row total">
          <span>Total</span>
          <span class="total-amount">${{ cartTotal() }}</span>
        </div>

        <button mat-raised-button color="primary" class="checkout-btn" 
                (click)="proceedToCheckout()">
          <mat-icon>payment</mat-icon>
          PROCEED TO CHECKOUT
        </button>

        <button mat-stroked-button class="continue-btn" (click)="continueShopping()">
          CONTINUE SHOPPING
        </button>

        <button mat-button class="clear-btn" (click)="clearCart()">
          <mat-icon>delete_sweep</mat-icon>
          Clear Cart
        </button>
      </mat-card>
    </div>
  </div>
</div>
